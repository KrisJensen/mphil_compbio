#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Apr 22 16:21:29 2019

@author: kris
"""

from msprime_coal import sim_genome
import numpy as np
import matplotlib.pyplot as plt
import msprime
import time
import pickle

nleaves = range(19, 38)
indps = [1.4833331078434333e-05,
0.00014833331078434333,
0.0007787498816178025,
0.002855416232598609,
0.008209321668721,
0.019702372004930403,
0.041046608343605004,
0.07622941549526645,
0.12863713864826212,
0.2001022156750744,
0.2901482127288579,
0.39565665372116987,
0.5110565110565111,
0.628992628992629,
0.7413127413127413,
0.8401544401544402,
0.918918918918919,
0.972972972972973,
1.0]
ps = []
for i in range(len(indps)):
    ps.append((1-sum(ps))*indps[i])

indps = [5.6167145457814216e-05,
0.0005055043091203279,
0.0024011454683215577,
0.008003818227738525,
0.02101002284781363,
0.04622205026518999,
0.08859226300828081,
0.15187245087133852,
0.23730070448646645,
0.3427676842582293,
0.46273637374860954,
0.5889372029527759,
0.7116324535679375,
0.8211143695014663,
0.9090909090909091,
0.9696969696969697,
1.0]
ps2 = []
for i in range(len(indps)):
    ps2.append((1-sum(ps2))*indps[i])

chr_ls=[249250621,
        243199373,
        198022430,
        191154276,
        180915260,
        171115067,
        159138663,
        146364022,
        141213431,
        135534747,
        135006516,
        133851895,
        115169878,
        107349540,
        102531392,
        90354753,
        81195210,
        78077248,
        63025520,
        59128983,
        51304566,
        48129895]
chr_ls.reverse()

Ne = 10**3
n = 38
nall = 31
tGen = 25

tminsall = []
for i in range(100):
    #use fake chromosome lengths since otherwise this takes ages
    talls, tmins = sim_genome(n=2, Ne=100000, chr_ls = [10**7 for i in range(10)])
    tminsall.append(tmins)